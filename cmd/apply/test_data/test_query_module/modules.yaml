rules:
  - name: ebs_encryption_is_disabled_by_default
    query: |
      SELECT
        *
      FROM
        aws_ec2_regional_configs
      WHERE
        ebs_encryption_enabled_by_default IS FALSE;
    labels:
      resource_account_id: '{{.account_id}}'
      resource_id: '{{.arn}}'
      resource_region: '{{.region}}'
      resource_type: S3
      bucket_url: 'https://{{.name}}.s3.{{.region}}.amazonaws.com'
      test:
        - test-b:
            test: test
            test1: test1
    metadata:
      author: Selefra
      description: Ensure to configure secure CORS rules for the Bucket.
      id: SF010117
      provider: AWS
      remediation:
      severity: Low
      tags:
        - Security
        - Misconfiguration
      title: S3 Bucket is not configured with CORS rules
    output: "EBS encryption is disabled by default, region id: {{.region}}"

selefra:
  cloud:
    project: example_project
    organization: example_org
  #    hostname: app.selefra.io
  connection:
    type: postgres
    username: postgres
    password: pass
    host: localhost
    port: "5432"
    database: postgres
    sslmode: disable
  name: example_project
  cli_version: v0.0.1
  providers:
    - name: aws
      source: aws
      version: latest
#    - name: gcp
#      source: gcp
#      version: ">=0.0.9,<=0.0.10"


providers:
  - name: aws_001
    cache: 1d
    provider: aws
    max_goroutines: 100